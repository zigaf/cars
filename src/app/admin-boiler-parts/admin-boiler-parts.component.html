<div class="container mt-4">
  <h2>Boiler Parts</h2>

  <button class="btn btn-success mb-3" (click)="createNew()">+ –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É</button>

  <!-- –¢–∞–±–ª–∏—Ü–∞ -->
  <table class="table table-dark table-hover table-bordered">
    <thead>
    <tr>
      <th>ID</th>
      <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
      <th>–¶–µ–Ω–∞</th>
      <th>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</th>
      <th>–í –Ω–∞–ª–∏—á–∏–∏</th>
      <th>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</th>
      <th>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let part of parts">
      <td>{{ part.id }}</td>
      <td>{{ part.name }}</td>
      <td>{{ part.price | number }}</td>
      <td>{{ part.boiler_manufacturer }}</td>
      <td>{{ part.in_stock }}</td>
      <td>
          <span *ngFor="let c of part.configuration; let last = last">
            {{c}}{{last ? '' : ', '}}
          </span>
      </td>
      <td>
        <ng-container *ngFor="let img of asArray(part.images); let last = last">
          <a [href]="img" target="_blank">–§–æ—Ç–æ{{last ? '' : ', '}}</a>
        </ng-container>
      </td>
      <td>
        <button class="btn btn-sm btn-primary me-2" (click)="edit(part)">‚úèÔ∏è</button>
        <button class="btn btn-sm btn-danger" (click)="delete(part.id)">üóëÔ∏è</button>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div class="modal fade show" tabindex="-1" [ngClass]="{'d-block': formVisible}" *ngIf="formVisible" style="background: rgba(0,0,0,0.7)">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">{{ selectedPart ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' : '–°–æ–∑–¥–∞—Ç—å' }} –º–∞—à–∏–Ω—É</h5>
          <button type="button" class="btn-close" (click)="cancel()"></button>
        </div>
        <form [formGroup]="editForm" (ngSubmit)="save()">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
              <input formControlName="name" class="form-control" />
            </div>
            <div class="col-md-3 mb-3">
              <label>–¶–µ–Ω–∞</label>
              <input formControlName="price" type="number" class="form-control" />
            </div>
            <div class="col-md-3 mb-3">
              <label>–í –Ω–∞–ª–∏—á–∏–∏</label>
              <input formControlName="in_stock" type="number" class="form-control" />
            </div>

            <div class="col-md-6 mb-3">
              <label>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (–º–∞—à–∏–Ω—ã)</label>
              <input formControlName="boiler_manufacturer" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (–∑–∞–ø—á–∞—Å—Ç–∏)</label>
              <input formControlName="parts_manufacturer" class="form-control" />
            </div>

            <div class="col-md-6 mb-3">
              <label>–ö–æ–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è</label>
              <input formControlName="vendor_code" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–ú–æ–¥–µ–ª—å</label>
              <input formControlName="Model" class="form-control" />
            </div>
            <div class="col-md-3 mb-3">
              <label>–ì–æ–¥</label>
              <input formControlName="Year" class="form-control" />
            </div>
            <div class="col-md-3 mb-3">
              <label>–ü—Ä–æ–±–µ–≥</label>
              <input formControlName="Mileage" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–î–≤–∏–≥–∞—Ç–µ–ª—å</label>
              <input formControlName="Engine" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–¢—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è</label>
              <input formControlName="Transmission" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–ü—Ä–∏–≤–æ–¥</label>
              <input formControlName="Drive" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–¢–æ–ø–ª–∏–≤–æ</label>
              <input formControlName="fuel" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ</label>
              <input formControlName="processed" class="form-control" />
            </div>

            <div class="col-md-6 mb-3">
              <label>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</label>
              <input formControlName="compatibility" class="form-control" />
            </div>
            <div class="col-md-6 mb-3">
              <label>–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å</label>
              <input formControlName="popularity" type="number" class="form-control" />
            </div>

            <div class="col-md-6 mb-3 d-flex align-items-center">
              <label class="me-2 mb-0">–•–∏—Ç –ø—Ä–æ–¥–∞–∂</label>
              <input formControlName="bestseller" type="checkbox" class="form-check-input" />
              <label class="ms-3 me-2 mb-0">–ù–æ–≤–∏–Ω–∫–∞</label>
              <input formControlName="new" type="checkbox" class="form-check-input" />
            </div>
          </div>

          <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è -->
          <div class="mb-3" formArrayName="configuration">
            <label>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</label>
            <div *ngFor="let conf of configuration.controls; let i = index" class="input-group mb-1">
              <input class="form-control" [formControlName]="i" placeholder="–û–ø—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..." />
              <button type="button" class="btn btn-outline-danger" (click)="configuration.removeAt(i)">‚úñÔ∏è</button>
            </div>
            <button type="button" class="btn btn-outline-primary btn-sm mt-2" (click)="configuration.push(fb.control(''))">+ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</button>
          </div>

          <!-- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ -->
          <div class="mb-3" formArrayName="images">
            <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (URL)</label>
            <div *ngFor="let img of images.controls; let i = index" class="input-group mb-1">
              <input class="form-control" [formControlName]="i" placeholder="https://..." />
              <button type="button" class="btn btn-outline-danger" (click)="images.removeAt(i)">‚úñÔ∏è</button>
            </div>
            <button type="button" class="btn btn-outline-primary btn-sm mt-2" (click)="images.push(fb.control(''))">+ –§–æ—Ç–æ</button>
          </div>

          <button class="btn btn-success me-2" type="submit">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <button class="btn btn-secondary" type="button" (click)="cancel()">‚ùå –û—Ç–º–µ–Ω–∞</button>
        </form>
      </div>
    </div>
  </div>
</div>
